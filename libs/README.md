# Libraries Setup

This folder contains setup instructions for GGPK Explorer dependencies. **No DLL files are stored in the repository** - they are downloaded and compiled automatically by the setup scripts.

## Required Files (Generated by Setup Scripts)

After running the setup scripts, this folder will contain:

```
libs/
├── LibGGPK3.dll          # Core GGPK file handling (auto-generated)
├── LibBundle3.dll        # Bundle file operations (auto-generated)
├── LibBundledGGPK3.dll   # Unified GGPK+Bundle access (auto-generated)
├── SystemExtensions.dll  # System extensions library (auto-generated)
├── oo2core.dll           # Oodle compression library (manual copy required)
└── README.md             # This file (version controlled)
```

**Note**: All DLL files are automatically generated and are excluded from version control via .gitignore.

## Setup Instructions

### Automated Setup (Recommended)

Use the automated setup scripts from the project root:

```powershell
# Complete setup for all dependencies (downloads and compiles automatically)
.\scripts\Setup-All-Dependencies.ps1

# Force re-setup even if dependencies exist
.\scripts\Setup-All-Dependencies.ps1 -Force

# Check dependency status and get setup instructions
.\scripts\Verify-Dependencies.ps1
```

**Important**: The setup script will:
1. **Download and compile** LibGGPK3 libraries from GitHub
2. **Download and compile** SystemExtensions from GitHub  
3. **Provide instructions** for manually copying oo2core.dll from Path of Exile
4. **Clean up** temporary files after compilation

### Manual Setup

#### 1. LibGGPK3 Libraries

Clone and build the LibGGPK3 repository with .NET 8 and unsafe code support:

```bash
# Clone the repository
git clone https://github.com/aianlinb/LibGGPK3.git temp-libggpk3
cd temp-libggpk3

# Note: You may need to manually configure projects for .NET 8 and unsafe code
# Edit .csproj files to add: <TargetFramework>net8.0</TargetFramework> and <AllowUnsafeBlocks>true</AllowUnsafeBlocks>

# Build the libraries
dotnet build LibGGPK3/LibGGPK3.csproj -c Release
dotnet build LibBundle3/LibBundle3.csproj -c Release  
dotnet build LibBundledGGPK3/LibBundledGGPK3.csproj -c Release

# Copy DLLs to libs folder
copy LibGGPK3\bin\Release\net8.0\LibGGPK3.dll ..\
copy LibBundle3\bin\Release\net8.0\LibBundle3.dll ..\
copy LibBundledGGPK3\bin\Release\net8.0\LibBundledGGPK3.dll ..\

# Clean up
cd ..
rmdir /s /q temp-libggpk3
```

#### 2. SystemExtensions Library

The setup script will automatically download, compile, and copy SystemExtensions.dll:

```powershell
# This is handled automatically by Setup-All-Dependencies.ps1
# Manual process (if needed):
git clone https://github.com/aianlinb/SystemExtensions.git temp-systemextensions
cd temp-systemextensions
dotnet build -c Release
copy bin\Release\net8.0\SystemExtensions.dll ..\SystemExtensions.dll
cd ..
rmdir /s /q temp-systemextensions
```

**Important**: SystemExtensions is compiled for .NET 8 with unsafe code support enabled.

#### 3. Oodle Compression Library (Manual Setup Required)

**This is the only dependency that requires manual setup** - oo2core.dll cannot be redistributed and must be copied from your Path of Exile installation:

```powershell
# Find your Path of Exile installation
Get-ChildItem -Path "C:\" -Name "oo2core_8_win64.dll" -Recurse -ErrorAction SilentlyContinue

# Copy from typical locations:
# Steam:
Copy-Item "C:\Program Files (x86)\Steam\steamapps\common\Path of Exile\oo2core_8_win64.dll" libs\oo2core.dll

# Standalone:
Copy-Item "C:\Program Files (x86)\Grinding Gear Games\Path of Exile\oo2core_8_win64.dll" libs\oo2core.dll

# Epic Games:
Copy-Item "C:\Program Files\Epic Games\PathOfExile\oo2core_8_win64.dll" libs\oo2core.dll
```

**Note**: The file is usually named `oo2core_8_win64.dll` in Path of Exile but should be renamed to `oo2core.dll` when copied to the libs folder.

## Verification

After completing the setup, verify that all files are present:

```powershell
# Use the verification script
.\scripts\Verify-Dependencies.ps1

# Or manually check:
ls libs\*.dll
```

Expected files:
- ✅ `LibGGPK3.dll` - Core GGPK functionality (auto-generated)
- ✅ `LibBundle3.dll` - Bundle file support (auto-generated)
- ✅ `LibBundledGGPK3.dll` - Unified GGPK access (auto-generated)
- ✅ `SystemExtensions.dll` - System extensions (auto-generated)
- ✅ `oo2core.dll` - Oodle compression (manual copy required)

## Build System Integration

The GGPK Explorer build system will:

1. **Detect required DLLs** in the libs folder
2. **Copy all DLLs** to the output directory during build
3. **Validate library presence** and display warnings if missing
4. **Support both Debug and Release** configurations
5. **Display status messages** during build

**Important**: If DLLs are missing, the build will fail with clear error messages directing you to run the setup scripts.

## Troubleshooting

### Missing DLL Errors
- Run `.\scripts\Setup-All-Dependencies.ps1` to download and compile missing libraries
- For oo2core.dll, manually copy from Path of Exile installation
- Use `.\scripts\Verify-Dependencies.ps1` to check status

### Build Errors
- Ensure .NET 8 SDK is installed
- Run setup scripts with `-Force` to re-download dependencies
- Check that git is available for downloading source repositories

### Oodle Compression Issues
- Verify oo2core.dll is the correct version
- Ensure the DLL is not blocked by Windows security
- Try running as administrator if needed

## Library Information

### LibGGPK3
- **Purpose**: Core GGPK file format handling
- **Repository**: https://github.com/aianlinb/LibGGPK3
- **License**: Check repository for license information

### LibBundle3  
- **Purpose**: Bundle file operations and decompression
- **Repository**: https://github.com/aianlinb/LibGGPK3 (part of LibGGPK3)
- **License**: Check repository for license information

### LibBundledGGPK3
- **Purpose**: Unified access to GGPK and bundle files
- **Repository**: https://github.com/aianlinb/LibGGPK3 (part of LibGGPK3)
- **License**: Check repository for license information

### SystemExtensions
- **Purpose**: System-level extensions and utilities
- **Repository**: https://github.com/aianlinb/SystemExtensions
- **License**: Check repository for license information

### oo2core.dll
- **Purpose**: Oodle compression/decompression
- **Source**: Path of Exile installation
- **License**: Proprietary (RAD Game Tools)